language: php

matrix:
  include:
    - php: 7.1
    - php: 7.2
    - php: 7.3

before_script:
  - wget http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest.tar.gz -O /tmp/dynamodb_local_latest.tar.gz
  - tar -xzf /tmp/dynamodb_local_latest.tar.gz -C /tmp
  - java -Djava.library.path=/tmp/DynamoDBLocal_lib -jar /tmp/DynamoDBLocal.jar -inMemory &
  - sleep 2

install:
  - travis_retry composer update
  - composer info

script:
  - vendor/bin/phpunit
  - vendor/bin/phpstan analyse 
  - git log $(git describe --abbrev=0 --tags)...HEAD --no-merges --pretty=format:"* [%h](http://github.com/${TRAVIS_REPO_SLUG}/commit/%H) %s (%cN)"

addons:
  hosts:
    - dynamodb-local
    - localhost

